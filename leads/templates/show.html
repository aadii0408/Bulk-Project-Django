{% extends 'base.html' %}


{% include 'navbar.html' %}


{% load static %}

<head>
<title>CSV DATA</title>
<style>
    .conatiner {
      display: flex;
  padding-inline-start: 0;
  list-style: none;
    }
    .contain {
     display: none;
    }
    .contain.on ~ .contain.on::before {
  content: ', ';
}
</style>
</head>
<body>

<center>
<b>These are the CSV Data</b>
</center>
<hr>
<br>
{% block content %}
<br>

<table id="csv-table" style="width:80%" >
      <thead class="table">
         <tr>
            <th id="fields-list">Header</th>
            <th>Data</th>
         </tr>
      </thead>
      <tbody>
<!--<tr>-->
<!--      <td>-->
<!--          <select name="leads" class="form-control">-->
<!--              <option value="name">Created At</option>-->

<!--              <option value="name">First Name</option>-->
<!--              <option value="name">Last Name</option>-->
<!--              <option value="name">Contact</option>-->
<!--              <option value="name">Email</option>-->
<!--              <option value="name">Country</option>-->
<!--              <option value="name">Industry</option>-->
<!--              <option value="name">Status</option>-->

<!--          </select>-->
<!--           <td>-->
<!--              {% for data in data %}-->
<!--              <td>{{ data.created_at }}</td>-->
<!--              {% endfor %}</td>-->
<!--</tr>-->

<!--          <br>-->
{% for i in columns %}
<tr>
  <td name="columnSelect">
    <select name="leads" class="form-control">
      {% if i == "created_at" %}
        <option value="createdAt" selected>Created At</option>
      {% else %}
        <option value="createdAt">Created At</option>
      {% endif %}
      
      {% if i == "first_name" %}
        <option value="firstName" selected>First Name</option>
      {% else %}
        <option value="firstName">First Name</option>
      {% endif %}

      {% if i == "last_name" %}
        <option value="lastName" selected>Last Name</option>
      {% else %}
        <option value="lastName">Last Name</option>
      {% endif %}

      {% if i == "contact" %}
        <option value="contact" selected>Contact</option>
      {% else %}
        <option value="contact">Contact</option>
      {% endif %}

      {% if i == "email" %}
        <option value="email" selected>Email</option>
      {% else %}
        <option value="email">Email</option>
      {% endif %}

      {% if i == "country" %}
        <option value="country" selected>Country</option>
      {% else %}
        <option value="country">Country</option>
      {% endif %}

      {% if i == "industry" %}
        <option value="industry" selected>Industry</option>
      {% else %}
        <option value="industry">Industry</option>
      {% endif %}

      {% if i == "status" %}
        <option value="status" selected>Status</option>
      {% else %}
        <option value="status">Status</option>
      {% endif %}

      {% if i == "skip" %}
        <option value="skip" selected>Skip</option>
      {% else %}
        <option value="skip">Skip</option>
      {% endif %}

    </select>
  </td>
  <td id="values">
    {% if i == "created_at" %}
      <p id="createdAt" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.created_at }}
      </p>
    {% endif %}

    {% if i == "first_name" %}
      <p id="firstName" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.first_name }}
      </p>
    {% endif %}

    {% if i == "last_name" %}
      <p id="lastName" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.last_name }}
      </p>
    {% endif %}

    {% if i == "contact" %}
      <p id="contact" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.contact }}
      </p>
    {% endif %}

    {% if i == "email" %}
      <p id="email" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.email }}
      </p>
    {% endif %}

    {% if i == "country" %}
      <p id="country" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.country }}
      </p>
    {% endif %}

    {% if i == "industry" %}
      <p id="industry" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.industry }}
      </p>
    {% endif %}

    {% if i == "status" %}
      <p id="status" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.status }}
      </p>
    {% endif %}

    {% if i == "skip" %}
      <p id="skip" style="display: block;max-width: 50vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{ data1.skip }}
      </p>
    {% endif %}
  </td>
<tr>
{%endfor%}
<!--          <select name="leads" class="form-control">-->

<!--              <option value="name">First Name</option>-->

<!--              <option value="name">Last Name</option>-->
<!--              <option value="name">Contact</option>-->
<!--              <option value="name">Email</option>-->
<!--              <option value="name">Country</option>-->
<!--              <option value="name">Industry</option>-->
<!--              <option value="name">Status</option>-->

<!--          </select>-->
<!--             <tr>-->

<!--              {% for data in data %}-->
<!--              <td>{{ data.first_name }}</td>-->
<!--              {% endfor %}-->
<!--</tr>-->
<!--                      <br>-->

<!--          <select name="leads" class="form-control">-->

<!--              <option value="name">Last Name</option>-->

<!--              <option value="name">Contact</option>-->
<!--              <option value="name">Email</option>-->
<!--              <option value="name">Country</option>-->
<!--              <option value="name">Industry</option>-->
<!--              <option value="name">Status</option>-->

<!--          </select>-->
<!--                      <br>-->

<!--          <select name="leads" class="form-control">-->

<!--              <<option value="name">Email</option>-->
<!--              <option value="name">Country</option>-->
<!--              <option value="name">Industry</option>-->
<!--              <option value="name">Status</option>-->

<!--          </select>-->
<!--                      <br>-->

<!--          <select name="leads" class="form-control">-->

<!--             <option value="name">Country</option>-->
<!--              <option value="name">Industry</option>-->
<!--              <option value="name">Status</option>-->

<!--          </select>-->
<!--                      <br>-->

<!--          <select name="leads" class="form-control">-->

<!--             <option value="name">Industry</option>-->
<!--              <option value="name">Status</option>-->


<!--          </select>-->
<!--                      <br>-->

<!--          <select name="leads" class="form-control">-->

<!--              <option value="name">Status</option>-->

<!--          </select>-->
<!--                      <br>-->





      </td>
</tr>



      </tbody>
   </table>


<br>
<br>
<br>

  </hr>
</div>
</body>
<br>
<style>
    #gap{
            margin-left: 180px;
            padding-up: 200px;
    }

</style>
<center>
  <button class="btn btn-success" onclick=formSubmit()>Import</button>
<a href="" class="btn btn-primary importbtn">Download Failed CSV</a>
</center>
    <br>
<hr>
 <h1>List of data</h1>
<hr>
<br>

<table class="table table-striped table-hover table-bordered" style="width:50%">
  <thead class="table-dark">
    <tr>
      <!-- <th scope="col">ID</th> -->
      <th scope="col">Created At</th>
      <th scope="col">First Name</th>
      <th scope="col">Last Name</th>
      <th scope="col">Contact</th>
      <th scope="col">Email</th>
      <th scope="col">Country</th>
      <th scope="col">Industry</th>
      <th scope="col">Status</th>
    </tr>
  </thead>
  <tbody>
	{% for i in data %}
		<tr>
      
<!--			<td><strong> {{i.Id}} </strong></td>-->
            <!-- <td><strong> {{ i.id }} </strong></td> -->
            <td><strong> {{ i.created_at.0 }} </strong></td>
            <td><strong> {{ i.first_name.0 }} </strong></td>
            <td><strong> {{ i.last_name.0 }} </strong></td>
            <td><strong> {{ i.contact.0 }} </strong></td>
            <td><strong> {{ i.email.0 }} </strong></td>
            <td><strong> {{ i.country.0 }} </strong></td>
            <td><strong> {{ i.industry.0 }} </strong></td>
            <td><strong> {{ i.status.0 }} {{ i.id }}</strong></td>
		</tr>
	{% endfor %}



	  </tbody>
	</table>
<script>
  const formSubmit = ()=>{
      const csvData = {}
      $("[name=columnSelect]").children("select").each(function(){
      const name=$(this).val()
      $(this).parent().parent().children("#values").each(function(){
          csvData[name] = $(this).children().html().trim()
      })
  })
  $.ajax({
    type: "POST",
    url: "/csvSave/",
    data: {data:JSON.stringify(csvData)},
    dataType: "application/json",
    success: function (response) {
      alert("Data Saved Successfully !!")
    },
    error: function (e) {
      alert(e.responseText);
    }
  });
}
  // $('[name="leads"]').change((e)=>{
  //   $(e.target).parent().parent().children("#values").children().each(function(value){$(this).css("display","none")});
  //   $(e.target).parent().parent().children("#values").children(`#${e.target.value}`).css("display","block");
  // })

  // $("leads").change((e)=>{
  //   console.log(e.target.value)
  // })
</script>
{% endblock %}

    </div>
  </div>
</div>

</html>


